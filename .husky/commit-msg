#!/usr/bin/env sh

# コミットメッセージに [Claude] または [Codex] のツールタグを要求
# verify.yml と同一基準（大文字小文字は区別）

MSG_FILE="$1"

# マージ/リバート/自動fixup・squashは許容
if grep -Eq '^(Merge|Revert|fixup!|squash!)' "$MSG_FILE"; then
  exit 0
fi

if ! grep -Eq '\[(Claude|Codex)\]' "$MSG_FILE"; then
  echo "❌ コミットメッセージに [Claude] または [Codex] のタグが必要です。" >&2
  echo "例: [Codex] マニフェスト参照を相対化" >&2
  exit 1
fi

exit 0

