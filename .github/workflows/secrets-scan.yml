- name: TruffleHog (pull_request)
          if: ${{ github.event_name == 'pull_request' }}
          uses: trufflesecurity/trufflehog@v3
          with:
            path: .
            base: ${{ github.event.pull_request.base.sha }}
            head: ${{ github.event.pull_request.head.sha }}
            extra_args: --only-verified --exclude-paths .trufflehogignore

        - name: TruffleHog (push)
          if: ${{ github.event_name == 'push' }}
          uses: trufflesecurity/trufflehog@v3
          with:
            path: .
            base: ${{ github.event.before }}
            head: ${{ github.sha }}
            extra_args: --only-verified --exclude-paths .trufflehogignore
